<!DOCTYPE html>
<html>
<head>
  <title><%= @title ? @title : "Time Saver" %></title>
  <%= stylesheet_link_tag "application", media: "all","data-turbolinks-track" => true %>
    <%= javascript_include_tag "application", "data-turbolinks-track" => true %>
  <%= csrf_meta_tags %>
  <%= favicon_link_tag 'favicon.ico' %>
  <link rel="apple-touch-icon" href="<%= image_path 'iTunesArtwork@2x.png' %>" />
  <meta name="viewport" content="width=device-width; initial-scale=1.0;" />
</head>
<body>
<%= render "layouts/navbar" %>
<div class="container">
<% flash.each do |key, value| %>
  <div class="alert alert-<%= key %>"><%= value %></div>
<% end %>
<%= yield %>
<% if signed_in? %>
<div id="hours_popup" style="width:150px;z-index:50;" class="hidden1">
	  <div id="test" style="display:none"></div><h3>Hours</h3>
	  		<div id="hours" style="display:none">Today: <span id="hours_day" style="padding:11px;"><%= (Schedule.total_time("day",current_user)/3600).round(2) %></span><br>
  				This Week:<span id="hours_week" style="padding:11px;"><%= (Schedule.total_time("week",current_user)/3600).round(2) %></span>
  				</div>
</div>
<script>
$(function() {
var i_day = <%= Schedule.total_time("day",current_user) %>
var i_week = <%= Schedule.total_time("week",current_user) %>
timers(<%= current_user.working? %>,i_day,i_week);
});
$( "div#hours_popup" ).click(function() {
 if ($("div#hours_popup").hasClass("hidden1")) {
		$( "div#hours" ).slideToggle("slow");
		$("div#hours_popup").css("bottom","0px");
		$("div#hours_popup").removeClass("hidden1")
		$("div#hours_popup").addClass("shown1")
	} else {
		$( "div#hours" ).slideToggle("slow");
		$("div#hours_popup").css("bottom","0px");
		$("div#hours_popup").addClass("hidden1")
		$("div#hours_popup").removeClass("shown1")
	}
});
function timers(working,i_day,i_week) {
	timer1 = parseFloat($('#test').text());
	clearInterval(timer1);
	$('#hours_day').text( Math.round(i_day/36)/100 );
	$('#hours_week').text( Math.round(i_week/36)/100 );
	if (working) {
		var start = new Date;
		var timer1 = setInterval(function() { 
			$('#hours_day').text( Math.round(((new Date - start)/1000 + i_day)/36)/100 );
			$('#hours_week').text( Math.round(((new Date - start)/1000 + i_week)/36)/100 );
		}, 1000)
		//var timer1 = setInterval(function() { $('#hours_day').text(i_day++) }, 1000);
	}
	$('#test').text(timer1);
}

</script>
<% end %>
</div>
</body>
</html>

