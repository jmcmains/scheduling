<h1>Time Saver</h1>
<%= link_to "Edit Schedule", schedules_path %> | <%= link_to "View Calendar", calendar_schedules_path %> | <%= link_to "View Time Spent", projects_path %>
<table>
<tr>
<%= form_tag(new_schedule_path, class: "form-inline", :style => "display:inline", method: :get) do %>
  <td style="text-align:left;vertical-align:center"><%= text_field_tag :name, "", data: {autocomplete_source: autocomplete_projects_path}, placeholder: "Project", class: "autocomplete", :style => "display:inline;margin:0" %></td>
  <td style="text-align:center;vertical-align:center">
  <button class="btn btn-success" name="go" type="submit">
  	<i class="icon-play icon-white"></i>
	</button>
<% end %>
</tr>

<% Project.all.sort_by(&:name).each do |project| %>
	<% if project.featured %>
	<tr>
		<td style="text-align:left"><%= link_to project.name, project_path(project) %></td>
		<td style="text-align:center;vertical-align:center">
		<%= form_tag(new_schedule_path, class: "form-inline", :style => "display:inline", method: :get) do %>
			<%= hidden_field_tag :name, project.name  %>
			<% if project.active? %>
				<button class="btn btn-danger" id="running" name="stop" type="submit">
					<i class="icon-pause icon-white"></i>
				</button>
			<% else %>
				<button class="btn btn-success" name="go" type="submit">
					<i class="icon-play icon-white"></i>
				</button>
			<% end %>	
		
		</td>
		<td>
			<button class="btn btn-danger" name="del" type="submit">
					<i class="icon-remove icon-white"></i>
			</button>
			</td>
	</tr>
	<% end %>
	<% end %>
<% end %>
</table>
<p>
<%= link_to "Edit Schedule", schedules_path %> | <%= link_to "View Calendar", calendar_schedules_path %> | <%= link_to "View Time Spent", projects_path %> <br>
<a href="JavaScript:newPopup('<%= root_path %>');">Open a popup window</a>
</p>
<span id="hours"><%= (Project.total_time/3600).round(2) %></span> hours worked today
<script>
$(function() {
	 $( ".autocomplete" ).autocomplete({
			source: $( "#name" ).data('autocomplete-source')
	});
});
// Popup window code
function newPopup(url) {
	popupWindow = window.open(
		url,'popUpWindow','height=580,width=350,right=10,bottom=10,resizable=no,scrollbars=no,toolbar=no,menubar=no,location=no,directories=no,status=no')
}
</script>
<script>
	if ($("#running").length > 0) {
  	var i = parseFloat('<%= Project.total_time %>');
  	var timer = setInterval(function() { $('#hours').text( i++ ) }, 1000)
  }
</script>

