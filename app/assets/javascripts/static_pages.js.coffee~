# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://jashkenas.github.com/coffee-script/

jQuery ->
  contresize = ->
    win_width = $(window).width()
    proCount = $("#projects").data('count')
    box_count = Math.min(Math.floor(win_width/box_width),proCount);
    box_width = $('.schedule').outerWidth()+11;
    total_width = box_count * box_width;
    $('#projects').css('width',total_width)
  schedTimer =  ->
    day = $("#hours_popup").data('day')
    week = $("#hours_popup").data('week')
    working = $("#hours_popup").data('working')
    timer1 = $('#hours_popup').data('timerFloat')
    clearInterval(timer1)
    $('#hours_day').text( Math.round(day/36)/100 )
    $('#hours_week').text( Math.round(week/36)/100 )
    if working
      start = new Date
      timer1 = setInterval ->
        $('#hours_day').text(Math.round(((new Date - start)/1000 + day)/36)/100)
        $('#hours_week').text( Math.round(((new Date - start)/1000 + week)/36)/100)
      , 1000
      $('#hours_popup').data('timerFloat',timer1)
  schedTimer()
  contresize()
  $( ".autocomplete-project" ).autocomplete source: $( "#name" ).data('autocomplete-source')
  $("#hours_popup").click ->
    if $("#hours_popup").hasClass("hidden1")
      $( "#hours" ).slideToggle("slow")
      $("#hours_popup").removeClass("hidden1")
      $("#hours_popup").addClass("shown1")
    else
      $( "#hours" ).slideToggle("slow")
      $("#hours_popup").addClass("hidden1")
      $("#hours_popup").removeClass("shown1")
  $(window).resize -> contresize()

	    


